import{_ as x}from"./nuxt-link.d9db1e92.js";import{_ as E}from"./InputPhone.4aa3b671.js";import{_ as N}from"./InputPassword.625c3685.js";import{c as R,F as H}from"./vee-validate.esm.a5d21a4f.js";import{_ as L,a as P}from"./success.b6063343.js";import{c as F,u as $,d as I,b as q,a as z}from"./entry.7aaca005.js";import{a as v,r as M,J as g,K as y,L as e,H as l,Z as u,u as n,X as m,U as i,R as j,O as G,ad as J,V as K,Q,a5 as X}from"./swiper-vue.6e12f478.js";import{u as w}from"./cookie.4132d486.js";import{u as Y}from"./composables.61e7926a.js";import{c as Z,d as W,a as ee}from"./index.esm.83261b9e.js";import{u as oe}from"./global.497c544a.js";import"./useAPILazyFetch.94301d64.js";const te={class:"login_form"},se={class:"xl:max-w-2xl"},ae={class:"mb-2"},ne={class:"mb-2"},le=["disabled"],ie={class:"mt-5 text-center text-secondary mb-0 font-sm"},re=e("img",{class:"icon",src:L,alt:"success icon"},null,-1),ce={__name:"AuthLogin",setup(S){const f=oe();R({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!1,validateOnModelUpdate:!0});const s=F(),d=q(),p=$(),_=I(),V=v(!1),h=Y(),t=M({phone:null,phone_code:null,password:null}),k=v(null);function T(o){t.phone_code=o.phone_code,k.value=o.phone_number_limit}const A=Z({phone:W().required(),password:ee().required()});async function B(){const o=new FormData;o.append("password",t.password),o.append("phone",t.phone),o.append("phone_code",t.phone_code);const a=w("phoneToVerify",{maxAge:30*60});try{const r=await $fetch(`${d.public.baseURL}client_web/login`,{method:"POST",body:o,headers:{Accept:"application/json",lang:p.locale.value,"Accept-Language":p.locale.value}});r.data.is_active?(w("session-token").value=r.data.token,f.fetchProfile(),s.push(h("/"))):(_.info(r.message),a.value={phone:t.phone,phone_code:t.phone_code,type:"new"},s.push(h("/auth/verify")))}catch(r){_.error(r.response._data.message)}}return(o,a)=>{const r=E,O=N,b=x,U=H,C=P;return g(),y("div",te,[e("div",se,[l(U,{as:"div",onSubmit:B,"validation-schema":n(A)},{default:u(({meta:D})=>[e("form",null,[e("div",ae,[l(r,{onCode_change:a[0]||(a[0]=c=>T(c)),name:"phone",modelValue:n(t).phone,"onUpdate:modelValue":a[1]||(a[1]=c=>n(t).phone=c)},null,8,["modelValue"])]),e("div",ne,[l(O,{name:"password",modelValue:n(t).password,"onUpdate:modelValue":a[2]||(a[2]=c=>n(t).password=c)},null,8,["modelValue"])]),l(b,{to:n(h)("/auth/reset-password"),class:"mt-3 text-end block pe-2 text-primary mb-0 font-medium"},{default:u(()=>[m(i(o.$t("labels.forgetYourPassword")),1)]),_:1},8,["to"]),e("button",{type:"submit",disabled:!D.valid,class:"base-btn w-full mt-11"},i(o.$t("BUTTONS.login")),9,le)])]),_:1},8,["validation-schema"]),e("p",ie,[m(i(o.$t("labels.dontHaveAnAccount"))+" ",1),l(b,{to:n(h)("/auth/register"),class:"text-primary ms-1 font-medium"},{default:u(()=>[m(i(o.$t("BUTTONS.createAccount")),1)]),_:1},8,["to"])])]),(g(),j(K,{to:"body"},[G(l(C,null,{default:u(()=>[re,e("h4",null,i(o.$t("HEADERS.loggedInSuccessfully")),1)]),_:1},512),[[J,n(V)]])]))])}}},ue={class:"auth_login"},me={class:"text-4xl md:text-5xl capitalize font-bold mb-11"},de={class:"text-4xl leading-9"},pe=e("br",null,null,-1),_e={class:"login_type"},Te={__name:"login",setup(S){const f=$();return z({title:f.t("NAV.login")}),(s,d)=>{const p=x,_=ce;return g(),y("div",ue,[e("form",{onSubmit:d[0]||(d[0]=X(()=>{},["prevent"])),class:"w-full md:max-w-xl mx-auto xl:mx-0"},[l(p,{to:s.localePath("/auth/login-type"),class:"text-lg text-text-dark mb-5 block font-medium"},{default:u(()=>[e("i",{class:Q(["pi text-base me-1",s.$i18n.locale=="ar"?"pi-arrow-right":"pi-arrow-left"])},null,2),m(" "+i(s.$t("BUTTONS.back")),1)]),_:1},8,["to"]),e("h1",me,[e("span",de,i(s.$t("HEADERS.hello")),1),pe,m(" "+i(s.$t("HEADERS.welcomeBack")),1)]),e("div",_e,[l(_)])],32)])}}};export{Te as default};
